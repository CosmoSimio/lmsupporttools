version: '3'

services:
  dns-web:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: dns-web
    volumes:
      - ./conf:/etc/bind
    ports:
      - "53:53/tcp"
      - "53:53/udp"
    environment:
      - TZ=UTC
    networks:
      - proxy

  downloader:
    image: nginx:latest
    volumes:
      - ./html:/usr/share/nginx/html
    command: >
      /bin/bash -c "apt-get update &&
                    apt-get install -y wget &&
                    wget https://lmsupporttools.s3.us-east-2.amazonaws.com/home.html &&
                    wget https://lmsupporttools.s3.us-east-2.amazonaws.com/abcgcalculator.html &&
                    wget https://lmsupporttools.s3.us-east-2.amazonaws.com/dynamicthresholdscalculator.html &&
                    cp /home.html /usr/share/nginx/html/ &&
                    cp /abcgcalculator.html /usr/share/nginx/html/ &&
                    cp /dynamicthresholdscalculator.html /usr/share/nginx/html/"
    networks:
      - proxy

networks:
  proxy:
    external: true